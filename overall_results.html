<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
    <script src="./static/video/log/anyvideo/anyvideo-hand_log.json"></script>
</head>

<body>
    <div id='myDiv'></div>
</body>
<script>
    var mcpX = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];
    var mcpY = [0.99, 0.99, 0.98, 0.98, 0.85, 0.85, 0.65, 0.64, 0.40, 0.38, 0.3];
    var colorTable = []

    var threshold = 0;
    var over9 = 0;
    var over7 = 0;
    var over5 = 0;
    var under5 = 0;
    var flag = true;

    for(var i=0 ; i<mcpX.length ; i++) {
        if (mcpY[i] >= 0.9) {
            colorTable.push('rgba(222, 45, 38, 0.8)');
            over9++;
        }
        else if (mcpY[i] >= 0.7) {
            colorTable.push('rgba(222, 45, 38, 0.6)');
            over7++;
        }
        else if (mcpY[i] >= 0.5) {
            colorTable.push('rgba(222, 45, 38, 0.4)');
            over5++;
        }
        else {
            if(flag){
                threshold = i+1 - 0.5;
                flag = false;
            }
            colorTable.push('rgba(222, 45, 38, 0.2)');
            under5++;
        }
    };

    var pieVal = [over9, over7, over5, under5];

    var trace1 = {
        x: mcpX,
        y: mcpY,
        xaxis: 'x1',
        yaxis: 'y1',
        type: 'bar',
        name: 'MCP(Mean Cheating Probability)',
        marker: {
            color: colorTable,
        }
        
    };

    var annotation1 = {
        x: [threshold],
        y: [0.97],
        text: 'Threshold',
        textfont: {
            family: 'sans serif',
            size: 12,
            color: 'rgba(22, 22, 22, 0.8)',
        },
        xaxis: 'x1',
        yaxis: 'y1',
        mode: 'text'
    };

    var table = {
        type: 'table',
        columnwidth: [150, 200, 200, 150],
        columnorder: [0, 1, 2, 3],
        header: {
            values: ['timestamp', 'probability'],
            align: "center",
            line: {width: 1, color: 'rgb(50, 50, 50)'},
            fill: {color: ['rgb(222, 45, 38)']},
            font: {family: "Arial", size: 11, color: "white"}
        },
        cells: {
            values: [mcpX, mcpY],
            align: ["center", "center"],
            line: {color: "black", width: 1},
            fill: {color: ['rgba(222, 45, 38, 0.2)', 'rgb(255, 255, 255)']},
            font: {family: "Arial", size: 10, color: ["black"]}
        },
        xaxis: 'x',
        yaxis: 'y',
        domain: {x: [0,0.4], y: [0, 1]}
    };
    
    var pie = {
       values: pieVal,
       labels: ['Over 0.9s', 'Over 0.7s', 'Over 0.5s', 'Thresholds'],
       type: 'pie',
       name: 'MCP Rate',
       hoverinfo: 'label+percent+name',
       hole: .4,
       marker: {
           colors: ['rgba(222, 45, 38, 0.8)','rgba(222, 45, 38, 0.6)','rgba(222, 45, 38, 0.4)','rgba(222, 45, 38, 0.2)']
       },
       domain: {
           row:0,
           column:0
       }
    };
    
    var data = [table, trace1, pie, annotation1];

    var axis = {
        showline: true,
        zeroline: false,
        showgrid: true,
        mirror: true,
        ticklen: 4,
        gridcolor: '#ffffff',
        tickfont: {size: 10}
    };

    var axis1 = {domain: [0.5, 1], anchor: 'y1', showticklabels: false};
    var axis2 = {domain: [0.5, 1], anchor: 'y2', showticklabels: false};
    var axis3 = {domain: [0.56, 1], anchor: 'x1', hoverformat: '.2f'};
    var axis4 = {domain: [0, 0.54], anchor: 'x2', hoverformat: '.2f'};

    var layout = {
        title : 'Mean Cheating Probability Report',
        showlegend:false,

        xaxis1: Object.assign(axis1, axis),
        xaxis2: Object.assign(axis2, axis),
        yaxis1: Object.assign(axis3, axis),
        yaxis2: Object.assign(axis4, axis),

        shapes: [
            {
                type: 'line',
                x0: threshold,
                y0: 0,
                x1: threshold,
                y1: 0.93,
                line: {
                    color: 'rgb(222, 45, 38)',
                    width: 2,
                    dash: 'dashdot'
                }
            }
        ],
        
        gird: {
            rows:2,
            columns:2
        },
    }

    Plotly.newPlot('myDiv', data, layout);
</script>

</html>